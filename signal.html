<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CandleLogic AI – Signal Generator</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    body {
      background: #0f172a;
      color: #fff;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
    }

    .container {
      max-width: 500px;
      margin: auto;
      background: #1e293b;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(0,0,0,0.6);
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
      color: #38bdf8;
    }

    label {
      display: block;
      margin: 10px 0 5px;
    }

    select {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: none;
      background: #334155;
      color: #fff;
      font-size: 16px;
      margin-bottom: 10px;
    }

    .button {
      background: #22c55e;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 16px;
      width: 100%;
      color: #fff;
      cursor: pointer;
    }

    .button:hover {
      background: #16a34a;
    }

    .signal-output {
      margin-top: 25px;
      background: #0f172a;
      padding: 20px;
      border: 1px solid #334155;
      border-radius: 12px;
    }

    .output-box {
      background: #1e293b;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      position: relative;
    }

    .signal-type {
      font-size: 24px;
      font-weight: bold;
    }

    .put {
      color: #f87171;
    }

    .call {
      color: #4ade80;
    }

    .copy-button {
      margin-top: 10px;
      background: #3b82f6;
      padding: 8px 12px;
      border-radius: 6px;
      color: #fff;
      border: none;
      cursor: pointer;
    }

    .copy-button:hover {
      background: #2563eb;
    }

    .rules {
      font-size: 14px;
      margin-top: 15px;
      padding: 10px;
      background: #1e293b;
      border-left: 4px solid #38bdf8;
      border-radius: 8px;
    }

    .status-valid {
      color: #4ade80;
      font-weight: bold;
    }

    .status-invalid {
      color: #f87171;
      font-weight: bold;
    }

    .output-label {
      font-size: 14px;
      color: #94a3b8;
    }

    .output-value {
      font-size: 18px;
      margin-top: 4px;
    }
  </style>
</head>
<body>

  <div class="container">
    <h2>🧠 CandleLogic AI</h2>

    <label>Last 5 Candle Colors:</label>
    <select id="candle1">
      <option value="">Select Candle 1</option>
      <option value="red">🔴 Red</option>
      <option value="green">🟢 Green</option>
    </select>
    <select id="candle2">
      <option value="">Select Candle 2</option>
      <option value="red">🔴 Red</option>
      <option value="green">🟢 Green</option>
    </select>
    <select id="candle3">
      <option value="">Select Candle 3</option>
      <option value="red">🔴 Red</option>
      <option value="green">🟢 Green</option>
    </select>
    <select id="candle4">
      <option value="">Select Candle 4</option>
      <option value="red">🔴 Red</option>
      <option value="green">🟢 Green</option>
    </select>
    <select id="candle5">
      <option value="">Select Candle 5 (Last Candle)</option>
      <option value="red">🔴 Red</option>
      <option value="green">🟢 Green</option>
    </select>

    <label>Running Candle:</label>
    <select id="runningCandle">
      <option value="">Select Running Candle</option>
      <option value="red">🔴 Red</option>
      <option value="green">🟢 Green</option>
    </select>

    <button class="button" onclick="generateSignal()">Generate Signal</button>

    <div class="signal-output" id="signalOutput" style="display:none;"></div>
  </div>

  <script>
    function generateSignal() {
      const c1 = document.getElementById("candle1").value;
      const c2 = document.getElementById("candle2").value;
      const c3 = document.getElementById("candle3").value;
      const c4 = document.getElementById("candle4").value;
      const c5 = document.getElementById("candle5").value;
      const running = document.getElementById("runningCandle").value;

      const output = document.getElementById("signalOutput");

      if (!(c1 && c2 && c3 && c4 && c5 && running)) {
        output.style.display = "block";
        output.innerHTML = `<div class="output-box"><span style="color:#f87171;">⚠️ Please select all candles and running candle.</span></div>`;
        return;
      }

      const candles = [c1, c2, c3, c4, c5];
      const reds = candles.filter(c => c === "red").length;
      const greens = candles.filter(c => c === "green").length;

      let signal = "";
      if (reds > greens) signal = "put";
      else if (greens > reds) signal = "call";
      else signal = "wait";

      // Validate based on last candle and running candle
      let isValid = true;
      if (c5 === running) {
        isValid = false;
      }

      const emoji = signal === "call" ? "🟢 CALL" : signal === "put" ? "🔴 PUT" : "⏳ WAIT";
      const status = isValid && signal !== "wait" ? `<span class="status-valid">✅ VALID</span>` : `<span class="status-invalid">❌ INVALID</span>`;
      const now = new Date();
      const nextMin = new Date(now.getTime() + 60 * 1000);
      const nextTime = nextMin.toTimeString().slice(0,5);

      const formatted = `
        <div class="output-box">
          <div class="signal-type ${signal}">${emoji}</div>
          <div class="output-label">➡️ Next Candle Time:</div>
          <div class="output-value">${nextTime}</div>
          <div class="output-label">Candle Count:</div>
          <div class="output-value">🔴 ${reds} | 🟢 ${greens}</div>
          <div class="output-label">Running Candle:</div>
          <div class="output-value">${running === "red" ? "🔴 RED" : "🟢 GREEN"}</div>
          <div class="output-label">Status:</div>
          <div class="output-value">${status}</div>
          <button class="copy-button" onclick="copyText()">📋 Copy Signal</button>
          <div class="rules">📘 Signal Rules<br>✅ Valid – Matches 1st Step MTG Rule<br>⛔ Invalid – Running candle matches last selected candle</div>
        </div>`;

      output.innerHTML = formatted;
      output.style.display = "block";
    }

    function copyText() {
      const output = document.querySelector(".output-box");
      const tempInput = document.createElement("textarea");
      tempInput.value = output.innerText.replace(/📋 Copy Signal.+/, '');
      document.body.appendChild(tempInput);
      tempInput.select();
      document.execCommand("copy");
      document.body.removeChild(tempInput);
      alert("✅ Signal copied!");
    }
  </script>

</body>
</html>
