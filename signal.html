<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CandleLogic AI – Signal</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #0d1117;
      color: #e6edf3;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    h1 {
      margin-top: 10px;
      font-size: 28px;
      color: #58a6ff;
    }
    .container {
      background-color: #161b22;
      border: 1px solid #30363d;
      border-radius: 10px;
      padding: 20px;
      max-width: 500px;
      width: 100%;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    .row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    select, button {
      width: 48%;
      padding: 8px;
      border: none;
      border-radius: 5px;
      font-size: 16px;
    }
    .red { background-color: #e74c3c; color: white; }
    .green { background-color: #2ecc71; color: white; }
    button.generate-btn {
      width: 100%;
      background-color: #58a6ff;
      color: white;
      margin-top: 10px;
    }
    .output {
      background-color: #0d1117;
      border: 1px solid #30363d;
      border-radius: 10px;
      padding: 15px;
      margin-top: 20px;
    }
    .copy-btn, .rules-link {
      background-color: #21262d;
      color: #c9d1d9;
      padding: 8px;
      margin-top: 10px;
      border-radius: 5px;
      cursor: pointer;
      border: none;
    }
    .copy-btn:hover, .rules-link:hover {
      background-color: #30363d;
    }
    #timerDisplay {
      margin-top: 10px;
      font-size: 18px;
      color: #ffa657;
    }
  </style>
</head>
<body>
  <h1>CandleLogic AI – Signal</h1>
  <div class="container">
    <div class="row">
      <select id="candle1">
        <option value="">Select Candle 1</option>
        <option value="green">🟢 Green</option>
        <option value="red">🔴 Red</option>
      </select>
      <select id="candle2">
        <option value="">Select Candle 2</option>
        <option value="green">🟢 Green</option>
        <option value="red">🔴 Red</option>
      </select>
    </div>
    <div class="row">
      <select id="candle3">
        <option value="">Select Candle 3</option>
        <option value="green">🟢 Green</option>
        <option value="red">🔴 Red</option>
      </select>
      <select id="candle4">
        <option value="">Select Candle 4</option>
        <option value="green">🟢 Green</option>
        <option value="red">🔴 Red</option>
      </select>
    </div>
    <div class="row">
      <select id="candle5">
        <option value="">Select Candle 5</option>
        <option value="green">🟢 Green</option>
        <option value="red">🔴 Red</option>
      </select>
      <select id="runningCandle">
        <option value="">Running Candle</option>
        <option value="green">🟢 Green</option>
        <option value="red">🔴 Red</option>
      </select>
    </div>
    <button class="generate-btn" onclick="generateSignal()" id="genBtn">🚀 Generate Signal</button>
    <div id="timerDisplay"></div>
    <div class="output" id="signalOutput" style="display:none;">
      <h3>✅ Signal Output Preview</h3>
      <p id="signalLine"></p>
      <p id="nextCandleLine"></p>
      <p id="countLine"></p>
      <p id="runningLine"></p>
      <p id="statusLine"></p>
      <p id="ruleLine"></p>
      <button class="copy-btn" onclick="copySignal()">📋 Copy Signal</button>
      <button class="rules-link" onclick="resetSignal()">🔁 Reset</button>
    </div>
  </div>

  <script>
    let timer;
    function generateSignal() {
      const candles = [
        document.getElementById('candle1').value,
        document.getElementById('candle2').value,
        document.getElementById('candle3').value,
        document.getElementById('candle4').value,
        document.getElementById('candle5').value
      ];
      const running = document.getElementById('runningCandle').value;

      const greens = candles.filter(c => c === 'green').length;
      const reds = candles.filter(c => c === 'red').length;

      let signal = 'WAIT';
      let valid = true;

      if (candles.includes('') || running === '') {
        alert('Please select all candles including running candle.');
        return;
      }

      if (greens > reds && running !== 'green') signal = 'CALL';
      else if (reds > greens && running !== 'red') signal = 'PUT';
      else valid = false;

      const now = new Date();
      const next = new Date(now.getTime() + 60000);
      const timeStr = now.toTimeString().slice(0,5);
      const nextStr = next.toTimeString().slice(0,5);

      document.getElementById('signalLine').textContent = `📱 Signal Type: ${signal === 'CALL' ? '⬆ CALL' : signal === 'PUT' ? '⬇ PUT' : '⏸ WAIT'}`;
      document.getElementById('nextCandleLine').textContent = `➡️ Next Candle Time: ${nextStr}`;
      document.getElementById('countLine').textContent = `🟢 Green: ${greens}      🔴 Red: ${reds}`;
      document.getElementById('runningLine').textContent = `📶 Running Candle: ${running === 'green' ? '🟢 GREEN' : '🔴 RED'}`;
      document.getElementById('statusLine').textContent = `📌 Status: ${valid ? '✅ VALID' : '❌ INVALID'}`;
      document.getElementById('ruleLine').textContent = valid ? '✅ Matches 1st Step MTG Rule' : '⚠️ Last Candle Matches Running Candle';

      document.getElementById('signalOutput').style.display = 'block';
      document.getElementById('genBtn').disabled = true;

      let countdown = 60;
      timer = setInterval(() => {
        countdown--;
        document.getElementById('timerDisplay').textContent = `⏳ Next Signal In: ${countdown}s`;
        if (countdown <= 0) {
          clearInterval(timer);
          document.getElementById('timerDisplay').textContent = '';
          document.getElementById('genBtn').disabled = false;
        }
      }, 1000);
    }

    function copySignal() {
      const signalText = `📡 Signal Type: ${document.getElementById('signalLine').textContent.split(': ')[1]}\n➡️ Next Candle Time: ${document.getElementById('nextCandleLine').textContent.split(': ')[1]}\n${document.getElementById('countLine').textContent}\n${document.getElementById('runningLine').textContent}\n${document.getElementById('statusLine').textContent}`;
      navigator.clipboard.writeText(signalText).then(() => alert('Signal Copied!'));
    }

    function resetSignal() {
      clearInterval(timer);
      document.getElementById("signalOutput").style.display = 'none';
      document.getElementById("signalLine").textContent = '';
      document.getElementById("nextCandleLine").textContent = '';
      document.getElementById("countLine").textContent = '';
      document.getElementById("runningLine").textContent = '';
      document.getElementById("statusLine").textContent = '';
      document.getElementById("ruleLine").textContent = '';
      document.getElementById("timerDisplay").textContent = '';
      document.getElementById("genBtn").disabled = false;
    }
  </script>
</body>
</html>
