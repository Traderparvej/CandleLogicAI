<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CandleLogic AI – Signal Generator</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h2>🧠 CandleLogic AI – Signal Generator</h2>
    <div class="form-section">
      <div class="input-group">
        <label>Select Last 5 Candles:</label>
        <div class="candle-selectors">
          <select id="candle1">
            <option value="">--</option>
            <option value="green">🟢 Green</option>
            <option value="red">🔴 Red</option>
          </select>
          <select id="candle2">
            <option value="">--</option>
            <option value="green">🟢 Green</option>
            <option value="red">🔴 Red</option>
          </select>
          <select id="candle3">
            <option value="">--</option>
            <option value="green">🟢 Green</option>
            <option value="red">🔴 Red</option>
          </select>
          <select id="candle4">
            <option value="">--</option>
            <option value="green">🟢 Green</option>
            <option value="red">🔴 Red</option>
          </select>
          <select id="candle5">
            <option value="">--</option>
            <option value="green">🟢 Green</option>
            <option value="red">🔴 Red</option>
          </select>
        </div>
      </div>

      <div class="input-group">
        <label>Running Candle:</label>
        <select id="runningCandle">
          <option value="">--</option>
          <option value="green">🟢 Green</option>
          <option value="red">🔴 Red</option>
        </select>
      </div>

      <button onclick="generateSignal()">🚀 Generate Signal</button>
    </div>

    <div id="signal-output" class="output-box" style="display:none;"></div>
  </div>

  <script>
    function generateSignal() {
      const candles = [
        document.getElementById("candle1").value,
        document.getElementById("candle2").value,
        document.getElementById("candle3").value,
        document.getElementById("candle4").value,
        document.getElementById("candle5").value
      ];

      const running = document.getElementById("runningCandle").value;

      if (candles.includes("") || running === "") {
        alert("Please select all candle colors.");
        return;
      }

      let greenCount = candles.filter(c => c === "green").length;
      let redCount = candles.filter(c => c === "red").length;

      const lastCandle = candles[4];
      const signalTime = new Date();
      const signalHH = String(signalTime.getHours()).padStart(2, '0');
      const signalMM = String(signalTime.getMinutes()).padStart(2, '0');
      const signalTimestamp = `${signalHH}:${signalMM}`;
      const nextMinute = new Date(signalTime.getTime() + 60000);
      const nextHH = String(nextMinute.getHours()).padStart(2, '0');
      const nextMM = String(nextMinute.getMinutes()).padStart(2, '0');
      const nextTimestamp = `${nextHH}:${nextMM}`;

      let signal = "WAIT";
      let valid = true;

      if (lastCandle === running) {
        valid = false;
      } else if (greenCount > redCount) {
        signal = "PUT";
      } else if (redCount > greenCount) {
        signal = "CALL";
      }

      const outputBox = document.getElementById("signal-output");
      outputBox.style.display = "block";
      outputBox.innerHTML = `
        ✅ Signal Output Preview<br>
        📡 Signal Type: ⬇ ${signal}<br>
        ➡️ Next Candle Time: ${nextTimestamp}<br>
        🟢 Green: ${greenCount} &nbsp;&nbsp; 🔴 Red: ${redCount}<br>
        📶 Running Candle: ${running === 'green' ? '🟢 GREEN' : '🔴 RED'}<br>
        ${valid ? "🟩 VALID Signal" : "🟥 INVALID Signal"}
      `;
    }
  </script>
</body>
</html>
