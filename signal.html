<!-- ‡¶∏‡¶¨ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ ‡¶•‡¶æ‡¶ï‡¶¨‡ßá ... -->

  <div id="output" class="output" style="display:none;"></div>

  <script>
    function copySignal() {
      const outputText = document.getElementById("output").innerText;
      navigator.clipboard.writeText(outputText).then(() => {
        alert("‚úÖ Signal copied to clipboard!");
      });
    }

    document.getElementById("generateBtn").addEventListener("click", function () {
      const candles = Array.from(document.querySelectorAll(".candle-select"))
        .map(select => select.value);
      const redCount = candles.filter(c => c === "red").length;
      const greenCount = candles.filter(c => c === "green").length;

      const runningCandle = document.querySelector("input[name='runningCandle']:checked");
      if (!runningCandle) return alert("Please select the running candle.");

      const timezoneOffset = parseFloat(document.getElementById("timezone").value);
      const nowUTC = new Date();
      const localTime = new Date(nowUTC.getTime() + timezoneOffset * 60 * 60 * 1000);
      const nextTime = new Date(localTime.getTime() + 60000);

      let signal = "WAIT";
      let statusText = "‚ùå INVALID";
      let signalClass = "invalid";
      let signalEmoji = "‚è∏";
      let validBox = `<div class="invalid-box">‚ùå Doesn't match Running Candle</div>`;

      if (redCount >= 3 && runningCandle.value === "green") {
        signal = "PUT";
        signalEmoji = "‚¨á";
        statusText = "‚úÖ VALID";
        signalClass = "valid";
        validBox = `<div class="valid-box">‚úÖ Matches 1st Step MTG Rule</div>`;
      } else if (greenCount >= 3 && runningCandle.value === "red") {
        signal = "CALL";
        signalEmoji = "‚¨Ü";
        statusText = "‚úÖ VALID";
        signalClass = "valid";
        validBox = `<div class="valid-box">‚úÖ Matches 1st Step MTG Rule</div>`;
      }

      const output = document.getElementById("output");
      output.style.display = "block";
      output.innerHTML = `
        <div class="output-row"><strong>üì° Signal Type:</strong> <span class="${signalClass}">${signalEmoji} ${signal}</span></div>
        <div class="output-row"><strong>‚û°Ô∏è Next Candle Time:</strong> ${nextTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: false })}</div>
        <div class="output-row"><strong>üü¢ Green:</strong> ${greenCount} &nbsp;&nbsp;&nbsp; üî¥ Red: ${redCount}</div>
        <div class="output-row"><strong>Running Candle:</strong> ${runningCandle.value === "green" ? "üü¢ GREEN" : "üî¥ RED"}</div>
        <div class="output-row"><strong>Status:</strong> <span class="${signalClass}">${statusText}</span></div>
        ${validBox}
        <br>
        <button class="copy-btn" onclick="copySignal()">üìã Copy Signal</button>
        <br><br>
        üìò <b>Signal Rules</b><br>
        ‚úÖ Valid ‚Äì Matches 1st Step MTG Rule<br>
        ‚ùå Invalid ‚Äì Doesn't match Running Candle
      `;
    });
  </script>

  <style>
    .output-row {
      margin-bottom: 10px;
      font-size: 17px;
    }

    .valid {
      color: #00ff87;
    }

    .invalid {
      color: #ff4f4f;
    }

    .valid-box, .invalid-box {
      margin-top: 10px;
      padding: 10px;
      border-radius: 8px;
      font-weight: bold;
      background: #2a2f39;
      text-align: center;
    }

    .valid-box {
      color: #00ff87;
    }

    .invalid-box {
      color: #ff4f4f;
    }

    .copy-btn {
      margin-top: 15px;
      padding: 8px 18px;
      background-color: #00ffd5;
      color: #000;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }

    .copy-btn:hover {
      background-color: #00c6aa;
    }
  </style>
